module StringRefinements
  UNESCAPABLE_PATTERNS = [
      %r{_design/.+/_view/.+}
    ]
  refine String do
    def cgi_escape
      return self if UNESCAPABLE_PATTERNS.any? {|pattern| self =~ pattern }
      return if nil?
      CGI.escape self
    end
  end
end
